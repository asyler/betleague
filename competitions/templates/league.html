{% extends 'base.html' %}

{% load competition_filters %}

{% block body %}
    <script
  src="https://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>


    <script src="https://cdnjs.cloudflare.com/ajax/libs/floatthead/2.0.3/jquery.floatThead.min.js"></script>
    <script>
    $(document).ready(function () {
        $('table#results_table').floatThead({
	position: 'fixed',
    top: 52,
    floatTableClass: 'results_table_float'
});
    });

    </script>
    <table id="results_table">
        <thead>
            <tr id="users">
                <td class="colspan" colspan="4"></td>
                {% for user in users %}
                    <td class="username">{{ user.username }}</td>
                {% endfor %}
            </tr>
            <tr id="total">
                <td class="colspan" colspan="4"></td>
                {% for user in users %}
                    <td class="points">{{ user.total_points }}</td>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for match in matches.values %}
                <tr class="match">
                    <td class="date">{{ match.datetime|date:"d.m.Y" }}</td>
                    <td class="time">{{ match.datetime|date:"H:i" }}</td>
                    <td class="home_team">{{ match.home_team }}</td>
                    <td class="away_team">{{ match.away_team }}</td>
                    {% for user in users %}
                        {% if match.has_result %}
                            <td class="bet_result">
                                {{ match.bets|get_item:user.pk|get_property:'result'|default_if_none:'' }}
                            </td>
                        {% else %}
                            <td class="bet">
                                {{ match.bets|get_item:user.pk|default_if_none:'' }}
                            </td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}