{% extends 'base.html' %}

{% load competition_filters %}

{% load static %}

{% block extra_head %}
    <link href="{% static 'competitions.css' %}" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/floatthead/2.0.3/jquery.floatThead.min.js"></script>
    <script src="{% static 'float_thead.js' %}"></script>
{% endblock extra_head %}

{% block body %}
    <table id="results_table">
        <thead>
            <tr id="users">
                <td class="colspan" colspan="4"></td>
                {% for user in users %}
                    <td class="username">{{ user.username }}</td>
                {% endfor %}
            </tr>
            <tr id="total">
                <td class="colspan" colspan="4"></td>
                {% for user in users %}
                    <td class="points">{{ user.total_points }}</td>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for match in matches.values %}
                <tr class="match">
                    <td class="date">{{ match.datetime|date:"d.m.Y" }}</td>
                    <td class="time">{{ match.datetime|date:"H:i" }}</td>
                    <td class="home_team">{{ match.home_team }}</td>
                    <td class="away_team">{{ match.away_team }}</td>
                    {% for user in users %}
                        {% if match.has_result %}
                            <td class="bet_result">
                                {{ match.bets|get_item:user.pk|get_property:'result'|default_if_none:'' }}
                            </td>
                        {% else %}
                            <td class="bet">
                                {{ match.bets|get_item:user.pk|default_if_none:'' }}
                            </td>
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>

{% endblock %}